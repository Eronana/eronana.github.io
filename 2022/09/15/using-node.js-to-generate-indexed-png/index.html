<!doctype html><html lang=en-us class=lang-en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content="PNG,Node.js,Web,JavaScript,Programming,"><meta name=description content="A glance of indexed PNG Most PNG images have three or four channels, that indicate RGB or RGBA.
But PNG files also support indexed images, so you can put a palette into it and use one channel to indicate the palette index to represent the image.
In this article, we are going to discuss how to generate indexed PNG images in Node.js.
According to the wiki Portable Network Graphics , we know several parts of png:"><meta itemprop=description content="A glance of indexed PNG Most PNG images have three or four channels, that indicate RGB or RGBA.
But PNG files also support indexed images, so you can put a palette into it and use one channel to indicate the palette index to represent the image.
In this article, we are going to discuss how to generate indexed PNG images in Node.js.
According to the wiki Portable Network Graphics , we know several parts of png:"><meta http-equiv=x-ua-compatible content="ie=edge"><meta itemprop=name content="Using Node.js to generate indexed PNG - undefined.md"><link href=https://undefined.md/index.xml title="Using Node.js to generate indexed PNG - undefined.md" type=application/rss+xml rel=alternate><title>Using Node.js to generate indexed PNG - undefined.md</title><link rel=stylesheet href="/main.0453e83e5996a6dfda496b76be0528e16681fd95f6305bd5817b8b9420cb2ff5.css" integrity="sha256-BFPoPlmWpt/aSWt2vgUo4WaB/ZX2MFvVgXuLlCDLL/U="><meta property="og:site_name" content="Using Node.js to generate indexed PNG - undefined.md"><meta property="og:type" content="article"><meta property="og:title" content="Using Node.js to generate indexed PNG"><meta property="og:description" content="A glance of indexed PNG Most PNG images have three or four channels, that indicate RGB or RGBA.
But PNG files also support indexed images, so you can put a palette into it and use one channel to indicate the palette index to represent the image.
In this article, we are going to discuss how to generate indexed PNG images in Node.js.
According to the wiki Portable Network Graphics , we know several parts of png:"><meta property="og:url" content="https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/"><meta property="article:publisher" content="https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/"><meta property="article:published_time" content="2022-09-15T16:04:21+08:00"><meta property="article:modified_time" content="2022-09-18T15:47:11+08:00"><meta name=theme-color content="#0594cb"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Using Node.js to generate indexed PNG - undefined.md"><meta name=apple-mobile-web-app-status-bar-style content="white"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Gorikokka"><meta name=twitter:creator content="@Gorikokka"><meta name=twitter:title content="Using Node.js to generate indexed PNG - undefined.md"><meta name=twitter:description content="A glance of indexed PNG Most PNG images have three or four channels, that indicate RGB or RGBA.
But PNG files also support indexed images, so you can put a palette into it and use one channel to indicate the palette index to represent the image.
In this article, we are going to discuss how to generate indexed PNG images in Node.js.
According to the wiki Portable Network Graphics , we know several parts of png:"><meta name=twitter:url content="https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=manifest href=/manifest.json><link href=/icon.png rel="shortcut icon"><link href=/icon.png rel=bookmark><link rel=apple-touch-icon href=/icon.png><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Using Node.js to generate indexed PNG","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/undefined.md\/2022\/09\/15\/using-node.js-to-generate-indexed-png\/"},"genre":"posts","keywords":"PNG, Node.js","wordcount":841,"url":"https:\/\/undefined.md\/2022\/09\/15\/using-node.js-to-generate-indexed-png\/","datePublished":"2022-09-15T16:04:21\u002b08:00","dateModified":"2022-09-18T15:47:11\u002b08:00","author":{"@type":"Person","name":"Taiming"},"description":""}</script></head><body class="dark:bg-darkBg dark:text-darkText"><div class="relative mx-auto shadow-lg md:max-w-4xl xl:max-w-4xl 2xl:max-w-4xl"><div class="main flex flex-col justify-between bg-white dark:bg-darkFg"><header class=relative><nav id=nav class="navbar top-0 z-10 flex items-center border-b px-5 py-6 dark:border-darkBorder md:px-10"><div class="route-items flex w-full items-center justify-around"><a title=Home data-active-link=/ href=/ class="relative flex cursor-pointer flex-col items-center text-gray-700 transition duration-300 ease-[ease]"><i class="eva eva-home flex h-8 w-8 items-center justify-center text-3xl leading-none text-gray-500 transition duration-300 ease-[ease] dark:text-darkTextPlaceholder"></i>
<span class="mt-1 block text-xs text-gray-400 dark:text-darkText sm:text-sm md:hidden">Home</span>
</a><a title=Archives data-active-link=/archives/ href=/archives/ class="relative flex cursor-pointer flex-col items-center text-gray-700 transition duration-300 ease-[ease]"><i class="eva eva-bar-chart flex h-8 w-8 items-center justify-center text-3xl leading-none text-gray-500 transition duration-300 ease-[ease] dark:text-darkTextPlaceholder"></i>
<span class="mt-1 block text-xs text-gray-400 dark:text-darkText sm:text-sm md:hidden">Archives</span>
</a><a title=Tags data-active-link=/tags/ href=/tags/ class="relative flex cursor-pointer flex-col items-center text-gray-700 transition duration-300 ease-[ease]"><i class="eva eva-hash flex h-8 w-8 items-center justify-center text-3xl leading-none text-gray-500 transition duration-300 ease-[ease] dark:text-darkTextPlaceholder"></i>
<span class="mt-1 block text-xs text-gray-400 dark:text-darkText sm:text-sm md:hidden">Tags</span>
</a><a title=About data-active-link=/about/ href=/about/ class="relative flex cursor-pointer flex-col items-center text-gray-700 transition duration-300 ease-[ease]"><i class="eva eva-person flex h-8 w-8 items-center justify-center text-3xl leading-none text-gray-500 transition duration-300 ease-[ease] dark:text-darkTextPlaceholder"></i>
<span class="mt-1 block text-xs text-gray-400 dark:text-darkText sm:text-sm md:hidden">About</span>
</a><a title=Search data-active-link=/search/ href=/search/ class="relative flex cursor-pointer flex-col items-center text-gray-700 transition duration-300 ease-[ease]"><i class="eva eva-search flex h-8 w-8 items-center justify-center text-3xl leading-none text-gray-500 transition duration-300 ease-[ease] dark:text-darkTextPlaceholder"></i>
<span class="mt-1 block text-xs text-gray-400 dark:text-darkText sm:text-sm md:hidden">Search</span></a></div></nav><div class="dark-mode-switch absolute right-0 top-0 z-10 cursor-pointer pr-2 pt-2 text-xl leading-none"><i class="eva eva-moon opacity-20 dark:opacity-70"></i></div></header><main class="relative flex flex-grow" id=swup><style>:root{--font:Roboto, "Helvetica Neue", Helvetica, Arial, sans-serif}</style><div class="type-posts layout- w-full"><div class="relative h-full"><div class="relative h-full"><div class="page-view-article flex h-full flex-col bg-white dark:bg-darkFg"><div class=relative><div><div class="-mb-2 w-full p-6 pb-0 text-3xl md:px-10">Using Node.js to generate indexed PNG</div></div></div><div class="article-info border-b p-6 pb-3 text-sm dark:border-darkBorder md:px-10"><div><div class="mb-3 mr-4 inline-flex items-center sm:rounded-full"><i class="eva eva-clock-outline mr-1"></i>
<span><time title="Published in 15 Sep 2022 16:04:21" datetime=2022-09-15T16:04:21+08:00>15 Sep 2022</time></span></div><span class="mb-3 mr-4 inline-flex items-center sm:rounded-full"><i class="eva eva-edit-2-outline mr-1"></i>
<span><time title="Last modified on: 18 Sep 2022 15:47:11" datetime=2022-09-18T15:47:11+08:00>18 Sep 2022</time></span></span><div class="mb-3 mr-4 inline-flex items-center sm:rounded-full"><i class="eva eva-flag-outline mr-1"></i>
<span>4 mins read</span></div></div><div class="mb-3 flex items-center"><i class="eva eva-pricetags-outline mr-1"></i>
<span class=mr-3>Tags</span><a href=/tags/png title=PNG class="group mr-2 flex items-center text-sm">
<i class="mr-1 text-gray-400 group-hover:text-theme">#</i>
<span class="text-gray-400 group-hover:text-theme">PNG</span>
</a><a href=/tags/node.js title=Node.js class="group mr-2 flex items-center text-sm"><i class="mr-1 text-gray-400 group-hover:text-theme">#</i>
<span class="text-gray-400 group-hover:text-theme">Node.js</span></a></div></div><aside class="toc border-b border-gray-300 px-5 py-5 dark:border-darkBorder md:px-10 2xl:fixed 2xl:top-10 2xl:m-0 2xl:-ml-72 2xl:w-72 2xl:border-none 2xl:p-0 2xl:py-4 2xl:pr-4"><header><h1 class="mb-3 text-2xl font-bold 2xl:mb-4">Table of Contents</h1></header><nav id=TableOfContents><ul><li><a href=#a-glance-of-indexed-png>A glance of indexed PNG</a></li><li><a href=#preparation>Preparation</a></li><li><a href=#header>Header</a></li><li><a href=#chunks>Chunks</a><ul><li><a href=#ihdr>IHDR</a></li><li><a href=#plte>PLTE</a></li><li><a href=#idat>IDAT</a></li><li><a href=#iend>IEND</a></li></ul></li><li><a href=#save-to-file>Save to file</a></li><li><a href=#the-indexed-png>The indexed-png</a></li></ul></nav></aside><section class="article-content typo relative flex-grow px-6 py-5 md:px-10"><i title="Faster Reads" id=bionicReading class="absolute right-0 top-0 cursor-pointer p-3"><svg class="w-4 h-4 fill-current text-gray-400" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="10811"><path d="M480 192c-19.2.0-32-12.8-32-32V32c0-19.2 12.8-32 32-32s32 12.8 32 32v128c0 19.2-12.8 32-32 32zM160 1024c-6.4.0-19.2.0-25.6-6.4l-128-128c0-6.4-6.4-19.2-6.4-25.6s6.4-19.2 6.4-25.6l512-512c12.8-6.4 38.4-6.4 51.2.0l128 128c0 6.4 6.4 19.2 6.4 25.6s-6.4 19.2-6.4 25.6l-512 512c-6.4 6.4-19.2 6.4-25.6 6.4zM76.8 864l83.2 83.2L627.2 480 544 396.8 76.8 864zM992 576H864c-19.2.0-32-12.8-32-32s12.8-32 32-32h128c19.2.0 32 12.8 32 32s-12.8 32-32 32zM768 288c-6.4.0-19.2.0-25.6-6.4-12.8-12.8-12.8-32 0-44.8l96-96c12.8-12.8 32-12.8 44.8.0s12.8 32 0 44.8l-96 96c0 6.4-12.8 6.4-19.2 6.4zm-512 0c-6.4.0-19.2.0-25.6-6.4l-96-96c-6.4-12.8-6.4-38.4.0-51.2s32-12.8 44.8.0l96 96c12.8 12.8 12.8 32 0 44.8.0 12.8-12.8 12.8-19.2 12.8zM864 896c-6.4.0-19.2.0-25.6-6.4l-96-96c-12.8-12.8-12.8-32 0-44.8s32-12.8 44.8.0l96 96c12.8 12.8 12.8 32 0 44.8.0 6.4-12.8 6.4-19.2 6.4z" p-id="10812"/><path d="M544 640c-6.4.0-19.2.0-25.6-6.4l-128-128c-6.4-12.8-6.4-38.4.0-51.2s32-12.8 44.8.0l128 128c12.8 12.8 12.8 38.4 6.4 51.2-6.4 6.4-19.2 6.4-25.6 6.4z" p-id="10813"/></svg></i><h2 class=group id=a-glance-of-indexed-png>A glance of indexed PNG<a href=#a-glance-of-indexed-png><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>Most PNG images have three or four channels, that indicate RGB or RGBA.<br>But PNG files also support indexed images, so you can put a palette into it and use one channel to indicate the palette index to represent the image.<br>In this article, we are going to discuss how to generate indexed PNG images in Node.js.</p><p>According to the wiki <a class=link href=https://en.wikipedia.org/wiki/Portable_Network_Graphics target=_blank rel=noopener>Portable Network Graphics</a>
, we know several parts of png:</p><ol><li>Every png file starts with an 8-byte PNG signature: <code>'\x89PNG\r\n\x1a\n'</code>.</li><li>Followings are chunks. the structure of chunks is:<ul><li><code>length of data</code>: 4 bytes</li><li><code>chunk type</code>: 4 bytes</li><li><code>data</code>: length bytes</li><li><code>CRC of type and data</code>: 4 bytes</li></ul></li><li>The 4 chunks are required for indexed PNG is <code>IHDR</code>, <code>PLTE</code>, <code>IDAT</code>, and <code>IEND</code>.</li></ol><h2 class=group id=preparation>Preparation<a href=#preparation><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>First of all, we should decide how the image should be created.<br>I think a colorful 16*16-sized image would be good.<br>Then we need an array of <code>Buffer</code> to store the PNG data.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> data <span style=color:#ff79c6>=</span> [];
</span></span></code></pre></td></tr></table></div></div><p>Then we can use <code>data.push(someBuffer)</code> to append chunk buffers to the data.</p><h2 class=group id=header>Header<a href=#header><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>Following the PNG format, just write the header.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>data.push(Buffer.from(<span style=color:#f1fa8c>&#39;\x89PNG\r\n\x1a\n&#39;</span>, <span style=color:#f1fa8c>&#39;latin1&#39;</span>)); <span style=color:#6272a4>// write the header
</span></span></span></code></pre></td></tr></table></div></div><h2 class=group id=chunks>Chunks<a href=#chunks><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>To write chunks properly, we need to implement a function called <code>generateChunk</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#6272a4>// use package crc-32 for calculate crc32,
</span></span></span><span style=display:flex><span><span style=color:#6272a4>// do not forget run `npm i crc-32` to install it.
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span><span style=color:#ff79c6>const</span> CRC32 <span style=color:#ff79c6>=</span> require(<span style=color:#f1fa8c>&#39;crc-32&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>function</span> generateChunk(type, data) {
</span></span><span style=display:flex><span>  <span style=color:#6272a4>// 4 bytes length + 4 bytes type + 4 bytes crc + data length
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>  <span style=color:#ff79c6>const</span> buffer <span style=color:#ff79c6>=</span> Buffer.alloc(<span style=color:#bd93f9>3</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>4</span> <span style=color:#ff79c6>+</span> data.length);
</span></span><span style=display:flex><span>  <span style=color:#6272a4>// should calculate the crc32 of type and data
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>  <span style=color:#ff79c6>const</span> crc <span style=color:#ff79c6>=</span> CRC32.buf(data, CRC32.bstr(type));
</span></span><span style=display:flex><span>  buffer.writeInt32BE(data.length);
</span></span><span style=display:flex><span>  buffer.write(type, <span style=color:#bd93f9>4</span>);
</span></span><span style=display:flex><span>  data.copy(buffer, <span style=color:#bd93f9>8</span>);
</span></span><span style=display:flex><span>  buffer.writeInt32BE(crc, buffer.length <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>4</span>);
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>return</span> buffer;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>There are 4 chunks to be written, let&rsquo;s solve them one by one.</p><h3 class=group id=ihdr>IHDR<a href=#ihdr><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h3><p>There are so many fields in IHDR, but only the width and height are what we really care about.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> ihdrData <span style=color:#ff79c6>=</span> Buffer.alloc(<span style=color:#bd93f9>13</span>);
</span></span><span style=display:flex><span>ihdrData.writeUInt32BE(<span style=color:#bd93f9>16</span>);
</span></span><span style=display:flex><span>ihdrData.writeUInt32BE(<span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>4</span>);
</span></span><span style=display:flex><span>ihdrData[<span style=color:#bd93f9>8</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>8</span>; <span style=color:#6272a4>// bit depth
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ihdrData[<span style=color:#bd93f9>9</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>; <span style=color:#6272a4>// color type = indexed color
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ihdrData[<span style=color:#bd93f9>10</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; <span style=color:#6272a4>// compression method, must be 0
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ihdrData[<span style=color:#bd93f9>11</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; <span style=color:#6272a4>// filter method, only 0 is avaliable
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ihdrData[<span style=color:#bd93f9>12</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span> <span style=color:#6272a4>// interlace method = no interlace
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span><span style=color:#6272a4>// write the chunk
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>data.push(generateChunk(<span style=color:#f1fa8c>&#39;IHDR&#39;</span>, ihdrData));
</span></span></code></pre></td></tr></table></div></div><h3 class=group id=plte>PLTE<a href=#plte><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h3><p>The palette, let&rsquo;s just make a colorful 256-length palette.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#6272a4>// 3 bytes(r, g, b) * 256
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span><span style=color:#ff79c6>const</span> plteData <span style=color:#ff79c6>=</span> Buffer.alloc(<span style=color:#bd93f9>256</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>3</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>  plteData[i <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>3</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> (i <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>7</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>36</span>; <span style=color:#6272a4>// red
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>  plteData[i <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>3</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>Math</span>.floor(i <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>7</span>) <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>7</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>36</span>; <span style=color:#6272a4>// green
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>  plteData[i <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>3</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>Math</span>.floor(i <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>7</span> <span style=color:#ff79c6>/</span> <span style=color:#bd93f9>7</span>) <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>36</span>; <span style=color:#6272a4>// blue
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data.push(generateChunk(<span style=color:#f1fa8c>&#39;PLTE&#39;</span>, plteData));
</span></span></code></pre></td></tr></table></div></div><h3 class=group id=idat>IDAT<a href=#idat><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h3><p>This chunk is the actual image data chunk, it includes indices of the color.<br>We can just fill it from <code>0</code> to <code>16 * 16 - 1</code> to show all colors in the palette sequential.<br>The data of IDAT chunk should be compressed by Deflate, the <code>zlib</code> should be used.<br>The pre-compressed data should contain height rows, and each line starts with a filter type. Indexed PNG does not need any filter, which means each row should start with 0(None).<br>Since there is an extra byte indicating filter type in rows, the size of the data is (width + 1) * height = (16 + 1) * 16;</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> zlib <span style=color:#ff79c6>=</span> require(<span style=color:#f1fa8c>&#39;zlib&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>const</span> uncompressedData <span style=color:#ff79c6>=</span> Buffer.alloc(<span style=color:#bd93f9>17</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> x <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; x <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>16</span>; x<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> y <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; y <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>16</span>; y<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>    uncompressedData[y <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>17</span> <span style=color:#ff79c6>+</span> x <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> y <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>16</span> <span style=color:#ff79c6>+</span> x;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#ff79c6>const</span> idatData <span style=color:#ff79c6>=</span> zlib.deflateSync(uncompressedData);
</span></span><span style=display:flex><span>data.push(generateChunk(<span style=color:#f1fa8c>&#39;IDAT&#39;</span>, idatData));
</span></span></code></pre></td></tr></table></div></div><h3 class=group id=iend>IEND<a href=#iend><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h3><p>No data with chunk IEND, just create an empty Buffer as data.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>data.push(generateChunk(<span style=color:#f1fa8c>&#39;IEND&#39;</span>, Buffer.alloc(<span style=color:#bd93f9>0</span>)));
</span></span></code></pre></td></tr></table></div></div><h2 class=group id=save-to-file>Save to file<a href=#save-to-file><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>Now we can concatenate the chunks to get the data buffer of the png image and write it into a file.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> fs <span style=color:#ff79c6>=</span> require(<span style=color:#f1fa8c>&#39;fs&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>const</span> buffer <span style=color:#ff79c6>=</span> Buffer.concat(data);
</span></span><span style=display:flex><span>fs.writeFileSync(<span style=color:#f1fa8c>&#39;indexed-image.png&#39;</span>, buffer);
</span></span></code></pre></td></tr></table></div></div><h2 class=group id=the-indexed-png>The indexed-png<a href=#the-indexed-png><i class="eva eva-link ml-3 align-middle text-theme opacity-0 transition ease-in-out group-hover:opacity-100"></i></a></h2><p>I&rsquo;ve created a package called <a class=link href=https://github.com/Eronana/indexed-png target=_blank rel=noopener>indexed-png</a>
to do this, you can use it to generate a indexed png easily:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>import</span> fs <span style=color:#ff79c6>=</span> require(<span style=color:#f1fa8c>&#39;fs&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>import</span> { createPNG } from <span style=color:#f1fa8c>&#39;indexed-png&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#ff79c6>const</span> palette <span style=color:#ff79c6>=</span> [];
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> r <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; r <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>6</span>; r<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> g <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; g <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>6</span>; g<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd;font-style:italic>let</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; b <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>6</span>; b<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span>      palette.push((r <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x33</span>) <span style=color:#ff79c6>|</span> ((g <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x33</span>) <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>8</span>) <span style=color:#ff79c6>|</span> ((b <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>0x33</span>) <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>16</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#ff79c6>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> width <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>36</span>;
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> height <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>6</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>const</span> data <span style=color:#ff79c6>=</span> Buffer.from(<span style=color:#8be9fd;font-style:italic>Array</span>(width <span style=color:#ff79c6>*</span> height).fill(<span style=color:#bd93f9>0</span>).map((_, i) =&gt; i <span style=color:#ff79c6>%</span> (<span style=color:#bd93f9>6</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>6</span> <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>6</span>)));
</span></span><span style=display:flex><span>  fs.writeFileSync(<span style=color:#f1fa8c>&#39;test.png&#39;</span>, (<span style=color:#ff79c6>await</span> createPNG(data, palette, width, height)));
</span></span><span style=display:flex><span>})();
</span></span></code></pre></td></tr></table></div></div></section><div class="px-6 pb-5 pt-4 text-center text-xl text-gray-500 md:px-10 md:pb-10 md:pt-14"><a class="mr-4 inline-flex h-5 w-5 items-center" title="Share to twitter" href="https://twitter.com/share?&text=A%20glance%20of%20indexed%20PNG%20Most%20PNG%20images%20have%20three%20or%20four%20channels,%20that%20indicate%20RGB%20or%20RGBA.But%20PNG%20files%20also%20support%20indexed%20images,%20so%20you%20can%20put%20a%20palette%20into%20it%20and%20use%20one%20channel%20to%20indicate%20the%20palette%20index%20to%20represent%20the%20image.In%20this%20article,%20we%20are%20going%20to%20discuss%20how%20to%20generate%20indexed%20PNG%20images%20in%20Node.js.According%20to%20the%20wiki%20Portable%20Network%20Graphics%20,%20we%20know%20several%20parts%20of%20png:&url=https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/" target=_blank rel="noopener noreferrer"><i class="eva eva-twitter hover:text-theme"></i></a><a class="mr-4 inline-flex h-5 w-5 items-center" title="Share to facebook" href="https://www.facebook.com/sharer.php?u=https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/" target=_blank rel="noopener noreferrer"><i class="eva eva-facebook hover:text-theme"></i></a><i class="eva eva-copy mr-4 cursor-pointer hover:text-theme" title="Copy Link" data-clipboard-text=https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/></i><div class="group relative hidden cursor-pointer sm:inline-block"><i title="QR Code" class="eva show-qrcode eva-smartphone hover:text-theme"></i><div class="qrcode-wrapper pointer-events-none absolute left-2/4 bottom-10 h-32 w-32 -translate-x-1/2 overflow-hidden rounded border border-gray-300 bg-white opacity-0 transition duration-300 ease-[ease] group-hover:opacity-100"><img class="h-full w-full" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://undefined.md/2022/09/15/using-node.js-to-generate-indexed-png/" alt="QR Code"></div></div></div><div class="border-b dark:border-darkBorder"></div><div class="flex justify-between px-2 py-4 text-xl md:px-6 md:text-2xl"><div><a href title class="invisible flex cursor-pointer items-center text-gray-500 transition duration-300 ease-[ease] hover:text-theme dark:text-darkTextPlaceholder dark:hover:text-darkText"><span class="flex items-center text-5xl opacity-70 dark:bg-opacity-100"><i class="eva eva-chevron-left-outline"></i></span>
<span>Prev</span></a></div><div class="hidden items-center text-xs xl:flex">Unless otherwise stated, this blog is licensed under 「
<a href=https://creativecommons.org/licenses/by-nc-nd/4.0 target=_blank rel="noopener noreferrer" class=text-theme>CC BY-NC-ND 4.0</a>
」</div><div class="flex items-center text-sm xl:hidden"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 target=_blank rel="noopener noreferrer" class=text-theme><img src=/Cc-by-nc-nd.svg alt="CC BY-NC-ND 4.0" title="CC BY-NC-ND 4.0" class=w-24></a></div><a href=/2022/09/16/wrong-alpha-premultiplication-on-ios-safari/ title="Wrong alpha premultiplication on iOS Safari" class="invisible flex cursor-pointer items-center text-gray-500 transition duration-300 ease-[ease] hover:text-theme dark:text-darkTextPlaceholder dark:hover:text-darkText" style=visibility:visible><span>Next</span>
<span class="flex items-center text-5xl opacity-70 dark:bg-opacity-100"><i class="eva eva-chevron-right-outline"></i></span></a></div><div class="border-t py-6 px-6 md:px-8 dark:border-darkBorder"><script src=https://giscus.app/client.js data-repo=Eronana/eronana.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkyNjMwNDM3MA==" data-category=Comments data-category-id=DIC_kwDOAZFfcs4CRc8l data-mapping=title data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=light data-lang=en data-loading=false crossorigin=anonymous data-swup-reload-script async></script><script>(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onThemeChange",e);function e(){document.documentElement.dataset.scheme==="light"?setGiscusTheme('light'):setGiscusTheme('dark')}})();function setGiscusTheme(t){let e=document.querySelector("iframe.giscus-frame");e&&e.contentWindow.postMessage({giscus:{setConfig:{theme:t}}},"https://giscus.app")}</script></div></div></div></div></div></main><footer><div class="com-footer flex flex-col items-center border-t py-4 px-4 text-sm leading-none text-gray-600 dark:border-darkBorder dark:text-darkTextPlaceholder md:flex-row md:justify-between"><div class="mb-2 flex items-center justify-between text-center md:mb-0"><span>© 2022 - 2022</span>
<span class="mx-1.5 opacity-50">| </span>Powered by <a data-no-swup class="mx-1 font-bold hover:text-theme" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> <span class="text-xs opacity-70">❤</span> <a data-no-swup class="mx-1 font-bold hover:text-theme" href=https://github.com/Ice-Hazymoon/hugo-theme-luna target=_blank rel="noopener noreferrer">Luna</a></div><div class="flex items-center"><span class="noscript-hidden mx-1.5 hidden opacity-50 md:block">| </span><a data-no-swup href=https://undefined.md/index.xml target=_blank class="mr-1.5 hover:text-theme"><span class="md:hidden lg:inline"><svg t="1650887361919" class="mr-0.5 w-96 w-3 fill-current text-inherit inline-block align-top" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="3091"><path d="M320.16155 831.918c0 70.738-57.344 128.082-128.082 128.082S63.99955 902.656 63.99955 831.918s57.344-128.082 128.082-128.082 128.08 57.346 128.08 128.082zm351.32 94.5c-16.708-309.2-264.37-557.174-573.9-573.9C79.31155 351.53 63.99955 366.21 63.99955 384.506v96.138c0 16.83 12.98 30.944 29.774 32.036 223.664 14.568 402.946 193.404 417.544 417.544 1.094 16.794 15.208 29.774 32.036 29.774h96.138c18.298.002 32.978-15.31 31.99-33.58zm288.498.576c-16.788-467.64-393.05-846.104-862.974-862.974C78.94555 63.372 63.99955 77.962 63.99955 96.032v96.136c0 17.25 13.67 31.29 30.906 31.998 382.358 15.678 689.254 322.632 704.93 704.93.706 17.236 14.746 30.906 31.998 30.906h96.136c18.068-.002 32.658-14.948 32.01-33.008z" p-id="3092"/></svg></span><span>RSS</span>
</a><a data-no-swup href=https://undefined.md/sitemap.xml target=_blank class="mr-1.5 hover:text-theme"><span class="md:hidden lg:inline"><svg t="1650887940556" class="mr-0.5 w-3 fill-current text-inherit inline-block align-top" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="6291"><path d="M950.044 625.778h-68.266v-56.89c0-45.51-39.822-85.332-85.334-85.332h-256v-85.334h68.267c39.822.0 73.956-34.133 73.956-73.955V130.844c0-39.822-34.134-73.955-73.956-73.955H415.29c-39.822.0-73.956 34.133-73.956 73.955v193.423c0 39.822 34.134 73.955 73.956 73.955h68.267v85.334h-256c-45.512.0-85.334 39.822-85.334 85.333v56.889H73.956C34.133 625.778.0 659.91.0 699.733v193.423c0 39.822 34.133 73.955 73.956 73.955h193.422c39.822.0 73.955-34.133 73.955-73.955V699.733c0-39.822-34.133-73.955-73.955-73.955H199.11v-56.89c0-17.066 11.378-28.444 28.445-28.444h568.888c17.067.0 28.445 11.378 28.445 28.445v56.889h-68.267c-39.822.0-73.955 34.133-73.955 73.955v193.423c0 39.822 34.133 73.955 73.955 73.955h193.422c39.823.0 73.956-34.133 73.956-73.955V699.733c0-39.822-34.133-73.955-73.956-73.955z" p-id="6292"/></svg></span><span>Sitemap</span></a><div id=google_translate_element class="overflow-hidden rounded border dark:border-darkBorder"></div></div><div id=run-time class="mt-2 flex-grow text-right md:mt-0"><span>Run time: </span><b id=run-time-d>0</b>
<span class=text-xs>days</span>
<b id=run-time-h>0</b>
<span class=text-xs>h</span>
<b id=run-time-m>0</b>
<span class=text-xs>m</span>
<b id=run-time-s>0</b>
<span class=text-xs>s</span></div></div><script type=text/javascript>window.__theme={cdn:'',pjax:!0,isServer:!1,$version:"0c2649eafd095927c4de3bec8928a69d2ece9b98",lang:'en-us',imageZoom:!0,lazyload:!0,bionicReading:{enabled:!0,skipLinks:!1,autoBionic:!1,excludeWords:[],excludeClasses:["github"],excludeNodeNames:[]},katex:!0,search:!0,backtop:!0,pangu:!1,autoDarkMode:!1,googleAnalytics:!1,hugoEncrypt:{wrongPasswordText:'Password is incorrect',userStorage:window.sessionStorage},console:{enabled:!0,leftColor:'#0088ff',rightColor:'#feb462',leftText:'undefined.md',rightText:'Powered by Hugo ❤ Luna'},assets:{error_svg:"/images/error.svg",search_svg:"/images/search.svg"},i18n:{copy:{success:"Copy success",failed:"Copy failed",copyCode:"Copy code"},search:{untitled:"Untitled",loadFailure:"Initialization of the search engine failed",input:"Type something..."},darkMode:{dark:"Switch to dark mode",light:"Switch to light mode"}},creatTime:"2022/09/15"}</script><script type=text/javascript src=/ts/main.37be8a59dd196c66cc46282b51b039580e7345372deb286d1478b8b5971da7b9.js defer integrity="sha256-N76KWd0ZbGbMRigrUbA5WA5zRTct6yhtFHi4tZcdp7k="></script><script>'serviceWorker'in navigator&&window.addEventListener('load',function(){navigator.serviceWorker.register('/sw.js')})</script>
<script type=text/javascript src=/translate-google.ecd37c3cc8f7e1b08910201dd0d9fc3e5f4b1395fb8ebead3141b931f036f777.js defer integrity="sha256-7NN8PMj34bCJECAd0Nn8Pl9LE5X7jr6tMUG5MfA293c="></script><script type=text/javascript>window.translateelement_styles="/sass/translateelement.min.c65796c6c3e4d48c75f72776948be83c5c448d1c5cc466b996b00657c558d28a.css";function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:'en-us',includedLanguages:'af,ga,sq,it,ar,ja,az,kn,eu,ko,bn,la,be,lv,bg,lt,ca,mk,zh-CN,ms,zh-TW,mt,hr,no,cs,fa,da,pl,nl,pt,en,ro,eo,ru,et,sr,tl,sk,fi,sl,fr,es,gl,sw,ka,sv,de,ta,el,te,gu,th,ht,tr,iw,uk,hi,ur,hu,vi,is,cy,id,yi',autoDisplay:!1},'google_translate_element')}</script>
<script></script><script data-swup-reload-script></script><script type=text/javascript src=/ts/custom.0bd59cb22c164acafaf3643704e7376a755284cac9c2efcbc578fcc606ad2bf2.js integrity="sha256-C9WcsiwWSsr682Q3BOc3anVShMrJwu/LxXj8xgatK/I=" data-swup-reload-script></script></footer></div></div><a href=#nav title="Back to top" id=back-top class="fixed right-6 bottom-9 z-10 translate-y-3 scale-90 cursor-pointer rounded-full bg-white opacity-0 transition duration-300 ease-[ease] dark:bg-darkBgAccent sm:scale-100"><div class=relative><div class="absolute left-0 top-0 flex h-full w-full items-center justify-center text-xl"><i class="eva eva-arrow-upward-outline"></i></div><svg id="svg" width="54" height="54" viewBox="0 0 54 54" preserveAspectRatio="xMinYMin meet"><circle transform="rotate(-90, 27 , 27)" style="stroke-dasharray:157,157;stroke-dashoffset:157" cx="27" cy="27" r="25" fill="none" stroke-width="4" stroke-linecap="round" stroke="var(--theme)"/></svg></div></a><noscript><style>.dark-mode-switch,#run-time,.noscript-hidden,[data-clipboard-text],[data-lazyload]{display:none}#back-top{opacity:1}.noscript-show{display:initial}</style></noscript></body></html>